"0","## Add a table with avg of all estimates each condition"
"0","## % bias (true - est)/true, if exceeds threshold then plot"
"0","# Compare with EMIM and Haplin errors, check why they look similar but bias is a little different"
"0","# Check power for imprinting, with diff eff sizes"
"0","# If Im is in the model, don't include E:M or M (but M works, although could be overparameterized)"
"0","bias <- mapply("
"0","  FUN = function(results, C, M, Im, If){"
"0","    point_est_means <- "
"0","      mapply("
"0","        FUN = function(mat){"
"0","          mat[,1]"
"0","        },"
"0","        mat = results"
"0","      ) %>%"
"0","      t() %>%"
"0","      colMeans() %>%"
"0","      exp()"
"0","    "
"0","    true_vals <- c(C = C, M = M, Im = Im, If = If)[names(point_est_means)]"
"0","    bias <- (true_vals - point_est_means)/true_vals"
"0","    return(bias)"
"0","  },"
"0","  results = tril_results,"
"0","  C = conditions$R,"
"0","  M = conditions$S,"
"0","  Im = conditions$Im,"
"0","  If = conditions$If"
"0",") %>%"
"0","  lapply(as.data.frame.list) %>%"
"0","  bind_rows() %>%"
"0","  rename(bias_C = ""C"","
"0","         bias_M = ""M"","
"0","         bias_Im = ""Im"","
"0","         bias_If = ""If"")"
"0",""
"0","reject_rate <- lapply("
"0","  X = tril_results,"
"0","  FUN = function(X){"
"0","    pvals <- "
"0","      mapply("
"0","        FUN = function(mat){"
"0","          mat[,2]"
"0","        },"
"0","        mat = X"
"0","      ) %>%"
"0","      t() %>%"
"0","      apply("
"0","        MARGIN = 2,"
"0","        FUN = function(x) (x < 0.05) %>% mean()"
"0","      )"
"0","  }"
"0",") %>%"
"0","  lapply(as.data.frame.list) %>%"
"0","  bind_rows() %>%"
"0","  rename(reject_C = ""C"","
"0","         reject_M = ""M"","
"0","         reject_Im = ""Im"","
"0","         reject_If = ""If"")"
"0",""
"0","conditions <- conditions %>% mutate(bias, reject_rate)"
"0","kable(conditions, caption = ""Conditions, bias and rejection rates"")"
